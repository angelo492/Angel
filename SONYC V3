-- SONYC UNIVERSAL HUD V4 - MM2 ELITE EDITION
local Player = game.Players.LocalPlayer
local Mouse = Player:GetMouse()
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

-- CONFIGURACIÓN INICIAL
local Config = {
    Speed = 16,
    HitboxSize = 2,
    SilentAim = false,
    ESP = true
}

-- CREACIÓN DE LA UI (ESTILO NEÓN)
local ScreenGui = Instance.new("ScreenGui", Player.PlayerGui)
ScreenGui.Name = "SONYC_ELITE"

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 280, 0, 420)
MainFrame.Position = UDim2.new(0.5, -140, 0.3, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
MainFrame.BackgroundTransparency = 0.1
MainFrame.Active = true
MainFrame.Draggable = true

local Stroke = Instance.new("UIStroke", MainFrame)
Stroke.Thickness = 3
Stroke.Color = Color3.fromRGB(0, 160, 255)
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 15)

-- TÍTULO Y BOTONES DE CONTROL
local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Text = "SONYC ELITE"
Title.Font = Enum.Font.GothamBold
Title.TextColor3 = Color3.new(1, 1, 1)
Title.TextSize = 22
Title.BackgroundTransparency = 1

local MinBtn = Instance.new("TextButton", MainFrame)
MinBtn.Size = UDim2.new(0, 25, 0, 25)
MinBtn.Position = UDim2.new(1, -35, 0, 10)
MinBtn.Text = "-"
MinBtn.BackgroundColor3 = Color3.fromRGB(0, 160, 255)
Instance.new("UICorner", MinBtn).CornerRadius = UDim.new(1, 0)

local Content = Instance.new("ScrollingFrame", MainFrame)
Content.Size = UDim2.new(1, -20, 1, -60)
Content.Position = UDim2.new(0, 10, 0, 50)
Content.BackgroundTransparency = 1
Content.CanvasSize = UDim2.new(0, 0, 1.5, 0)
Content.ScrollBarThickness = 2

local Layout = Instance.new("UIListLayout", Content)
Layout.Padding = UDim.new(0, 15)
Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-----------------------------------------------------------
-- FUNCIONES DE UTILIDAD (SLIDERS Y BOTONES)
-----------------------------------------------------------
local function CreateSlider(name, min, max, default, callback)
    local Label = Instance.new("TextLabel", Content)
    Label.Size = UDim2.new(0.9, 0, 0, 20)
    Label.Text = name .. ": " .. default
    Label.TextColor3 = Color3.new(1, 1, 1)
    Label.BackgroundTransparency = 1

    local SliderFrame = Instance.new("Frame", Content)
    SliderFrame.Size = UDim2.new(0.9, 0, 0, 10)
    SliderFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    Instance.new("UICorner", SliderFrame)

    local Fill = Instance.new("Frame", SliderFrame)
    Fill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
    Fill.BackgroundColor3 = Color3.fromRGB(0, 160, 255)
    Instance.new("UICorner", Fill)

    SliderFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            local connection
            connection = RunService.RenderStepped:Connect(function()
                local percent = math.clamp((Mouse.X - SliderFrame.AbsolutePosition.X) / SliderFrame.AbsoluteSize.X, 0, 1)
                Fill.Size = UDim2.new(percent, 0, 1, 0)
                local value = math.floor(min + (max - min) * percent)
                Label.Text = name .. ": " .. value
                callback(value)
                if not UIS:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) then
                    connection:Disconnect()
                end
            end)
        end
    end)
end

-----------------------------------------------------------
-- LÓGICA DE JUEGO (ESP, SPEED, HITBOX, SILENT)
-----------------------------------------------------------

-- 1. SPEED MODIFICABLE
CreateSlider("Velocidad", 16, 100, 16, function(v) Config.Speed = v end)
RunService.RenderStepped:Connect(function()
    if Player.Character and Player.Character:FindFirstChild("Humanoid") then
        Player.Character.Humanoid.WalkSpeed = Config.Speed
    end
end)

-- 2. HITBOX EXPANDIBLE
CreateSlider("Hitbox Size", 2, 50, 2, function(v) Config.HitboxSize = v end)
RunService.RenderStepped:Connect(function()
    for _, v in pairs(game.Players:GetPlayers()) do
        if v ~= Player and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
            v.Character.HumanoidRootPart.Size = Vector3.new(Config.HitboxSize, Config.HitboxSize, Config.HitboxSize)
            v.Character.HumanoidRootPart.Transparency = 0.7
            v.Character.HumanoidRootPart.CanCollide = false
        end
    end
end)

-- 3. ESP POR ROLES (Verde: Inocente, Rojo: Murder, Azul: Sheriff)
local function CreateESP(p)
    local highlight = Instance.new("Highlight")
    highlight.Name = "SONYC_ESP"
    highlight.Parent = p.Character
    highlight.FillTransparency = 0.5
    highlight.OutlineTransparency = 0
    
    RunService.RenderStepped:Connect(function()
        if p.Character and highlight.Parent then
            if p.Backpack:FindFirstChild("Knife") or p.Character:FindFirstChild("Knife") then
                highlight.FillColor = Color3.fromRGB(255, 0, 0) -- Rojo Murder
            elseif p.Backpack:FindFirstChild("Gun") or p.Character:FindFirstChild("Gun") then
                highlight.FillColor = Color3.fromRGB(0, 0, 255) -- Azul Sheriff
            else
                highlight.FillColor = Color3.fromRGB(0, 255, 0) -- Verde Inocente
            end
        end
    end)
end

game.Players.PlayerAdded:Connect(function(p)
    p.CharacterAdded:Connect(function() task.wait(1) CreateESP(p) end)
end)
for _, p in pairs(game.Players:GetPlayers()) do
    if p ~= Player then CreateESP(p) end
end

-- 4. SILENT AIM (Redirección de balas)
local SilentBtn = Instance.new("TextButton", Content)
SilentBtn.Size = UDim2.new(0.9, 0, 0, 40)
SilentBtn.Text = "SILENT AIM: OFF"
SilentBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
SilentBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", SilentBtn).CornerRadius = UDim.new(1, 0)

SilentBtn.MouseButton1Click:Connect(function()
    Config.SilentAim = not Config.SilentAim
    SilentBtn.Text = Config.SilentAim and "SILENT AIM: ON" or "SILENT AIM: OFF"
    SilentBtn.BackgroundColor3 = Config.SilentAim and Color3.fromRGB(0, 100, 0) or Color3.fromRGB(30, 30, 40)
end)

local mt = getrawmetatable(game)
local oldNamecall = mt.__namecall
setreadonly(mt, false)

mt.__namecall = newcclosure(function(self, ...)
    local method = getnamecallmethod()
    local args = {...}
    if Config.SilentAim and method == "FireServer" and self.Name == "Shoot" then
        for _, v in pairs(game.Players:GetPlayers()) do
            if v ~= Player and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
                -- Redirigir al Murderer si existe, si no al Sheriff
                if v.Character:FindFirstChild("Knife") or v.Backpack:FindFirstChild("Knife") then
                    args[1] = v.Character.HumanoidRootPart.Position
                    return oldNamecall(self, unpack(args))
                end
            end
        end
    end
    return oldNamecall(self, ...)
end)
setreadonly(mt, true)

-- Minimizar
MinBtn.MouseButton1Click:Connect(function()
    Content.Visible = not Content.Visible
    MainFrame:TweenSize(Content.Visible and UDim2.new(0, 280, 0, 420) or UDim2.new(0, 280, 0, 50), "Out", "Quart", 0.3, true)
end)

print("SONYC ELITE CARGADO.")
