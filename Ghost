-- SONYC PROJECT V19 - INVISIBLE GHOST DESYNC (REAL GRAB)
local Player = game.Players.LocalPlayer
local RunService = game:GetService("RunService")

local ProjectConfig = {
    SpeedActive = false,
    TargetSpeed = 24,
    EspActive = false,
    DesyncActive = false,
    GhostChar = nil
}

-- UI PRINCIPAL
local ScreenGui = Instance.new("ScreenGui", Player.PlayerGui)
ScreenGui.Name = "Sonyc_Ghost_V19"
ScreenGui.ResetOnSpawn = false

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 240, 0, 250)
MainFrame.Position = UDim2.new(0.5, -120, 0.5, -125)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 5, 15)
MainFrame.Active = true
MainFrame.Draggable = true
Instance.new("UICorner", MainFrame)
local MainStroke = Instance.new("UIStroke", MainFrame)
MainStroke.Color = Color3.fromRGB(255, 0, 255)
MainStroke.Thickness = 3

local Scroll = Instance.new("ScrollingFrame", MainFrame)
Scroll.Size = UDim2.new(1, -20, 1, -50)
Scroll.Position = UDim2.new(0, 10, 0, 40)
Scroll.BackgroundTransparency = 1
Scroll.CanvasSize = UDim2.new(0, 0, 0, 260)
Scroll.ScrollBarThickness = 0
local Layout = Instance.new("UIListLayout", Scroll)
Layout.Padding = UDim.new(0, 8)
Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-----------------------------------------------------------
-- LÓGICA DE INVISIBILIDAD Y DESYNC (GHOST MODE)
-----------------------------------------------------------
local function ToggleGhostDesync()
    local char = Player.Character
    if not char then return end
    local root = char:FindFirstChild("HumanoidRootPart")

    if ProjectConfig.DesyncActive then
        -- 1. Crear el Clon Visual (Lo que ven los demás)
        char.Archivable = true
        local Clone = char:Clone()
        Clone.Parent = workspace
        Clone:SetPrimaryPartCFrame(root.CFrame)
        for _, v in pairs(Clone:GetDescendants()) do
            if v:IsA("BasePart") then v.Anchored = true v.CanCollide = true end
            if v:IsA("LocalScript") or v:IsA("Script") then v:Destroy() end
        end
        ProjectConfig.GhostChar = Clone

        -- 2. Hacerte Invisible a ti (El real que se mueve)
        for _, v in pairs(char:GetDescendants()) do
            if v:IsA("BasePart") or v:IsA("Decal") then
                v.Transparency = v.Name == "HumanoidRootPart" and 1 or 0.7 -- Casi invisible para ti
            end
        end
    else
        -- Volver a la normalidad
        if ProjectConfig.GhostChar then
            ProjectConfig.GhostChar:Destroy()
            ProjectConfig.GhostChar = nil
        end
        for _, v in pairs(char:GetDescendants()) do
            if v:IsA("BasePart") or v:IsA("Decal") then
                v.Transparency = v.Name == "HumanoidRootPart" and 1 or 0
            end
        end
    end
end

local function CreateButton(text, configKey)
    local Btn = Instance.new("TextButton", Scroll)
    Btn.Size = UDim2.new(0.95, 0, 0, 38)
    Btn.Text = text .. ": OFF"
    Btn.Font = Enum.Font.GothamBold
    Btn.TextColor3 = Color3.new(1, 1, 1)
    Btn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    Instance.new("UICorner", Btn)
    local Stroke = Instance.new("UIStroke", Btn)
    Stroke.Color = Color3.fromRGB(255, 0, 255)
    Stroke.Enabled = false

    Btn.MouseButton1Click:Connect(function()
        ProjectConfig[configKey] = not ProjectConfig[configKey]
        Btn.Text = text .. (ProjectConfig[configKey] and ": ON" or ": OFF")
        Btn.BackgroundColor3 = ProjectConfig[configKey] and Color3.fromRGB(150, 0, 150) or Color3.fromRGB(30, 30, 40)
        Stroke.Enabled = ProjectConfig[configKey]
        if configKey == "DesyncActive" then ToggleGhostDesync() end
    end)
end

local SpeedInput = Instance.new("TextBox", Scroll)
SpeedInput.Size = UDim2.new(0.95, 0, 0, 35)
SpeedInput.Text = "24"
SpeedInput.Font = Enum.Font.GothamBold
SpeedInput.TextColor3 = Color3.new(1, 1, 1)
SpeedInput.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
Instance.new("UICorner", SpeedInput)

CreateButton("SPEED (NO RESET)", "SpeedActive")
CreateButton("ESP PLAYERS", "EspActive")
CreateButton("GHOST INVISIBLE (GRAB)", "DesyncActive")

-----------------------------------------------------------
-- CORE LOOPS
-----------------------------------------------------------
RunService.RenderStepped:Connect(function()
    local char = Player.Character
    local root = char and char:FindFirstChild("HumanoidRootPart")
    local hum = char and char:FindFirstChild("Humanoid")
    
    if root and hum and ProjectConfig.SpeedActive and hum.MoveDirection.Magnitude > 0 then
        root.Velocity = Vector3.new(hum.MoveDirection.X * ProjectConfig.TargetSpeed, root.Velocity.Y, hum.MoveDirection.Z * ProjectConfig.TargetSpeed)
    end
    
    -- Si el Ghost está activo, eliminamos colisiones para que no te trabes con tu clon
    if ProjectConfig.DesyncActive and char then
        for _, v in pairs(char:GetDescendants()) do
            if v:IsA("BasePart") then v.CanCollide = false end
        end
    end
end)

-- ESP Players
RunService.Heartbeat:Connect(function()
    for _, v in pairs(game.Players:GetPlayers()) do
        if v ~= Player and v.Character then
            local high = v.Character:FindFirstChild("SonycHighlight")
            if ProjectConfig.EspActive then
                if not high then
                    high = Instance.new("Highlight", v.Character)
                    high.Name = "SonycHighlight"
                    high.FillColor = Color3.fromRGB(255, 0, 255)
                end
            elseif high then high:Destroy() end
        end
    end
end)

SpeedInput.FocusLost:Connect(function() ProjectConfig.TargetSpeed = tonumber(SpeedInput.Text) or 24 end)

-- Minimizar
local MinBtn = Instance.new("TextButton", MainFrame)
MinBtn.Size = UDim2.new(0, 25, 0, 25)
MinBtn.Position = UDim2.new(1, -30, 0, 5)
MinBtn.Text = "-"
MinBtn.BackgroundColor3 = Color3.fromRGB(30, 20, 40)
MinBtn.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", MinBtn)

local isMin = false
MinBtn.MouseButton1Click:Connect(function()
    isMin = not isMin
    Scroll.Visible = not isMin
    MainFrame:TweenSize(isMin and UDim2.new(0, 240, 0, 35) or UDim2.new(0, 240, 0, 250), "Out", "Quart", 0.2, true)
    MinBtn.Text = isMin and "+" or "-"
end)
